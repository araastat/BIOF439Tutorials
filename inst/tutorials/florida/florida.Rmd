## Looking at Florida

.pull-left[
```{r f1, eval = F, echo = T}
library(maps)
states <- st_as_sf(maps::map('state', plot = F, 
                             fill = T)) %>% 
  cbind(st_coordinates(st_centroid(.))) %>% 
  mutate(ID = str_to_title(ID))

ggplot(data = world)+
  geom_sf() + 
  geom_sf(data = states, fill = NA) + 
  geom_text(data = states, aes(X, Y, label = ID), 
            size = 5) + 
  coord_sf(xlim = c(-88, -78), ylim = c(24.5, 33), 
           expand = F)
```
]
.pull-right[
![](04_annotations_figs/f1-1.png)
]

---

## Looking at Florida

.pull-left[
```{r f2, eval = F, echo = T}
library(maps)
states <- st_as_sf(map('state', plot = F, 
                       fill = T)) %>% 
  cbind(st_coordinates(st_centroid(states))) %>% 
  mutate(ID = str_to_title(ID))

ggplot(data = world)+
  geom_sf() + 
  geom_sf(data = states, fill = NA) + 
  geom_label(data = states, aes(X, Y, label = ID), #<<
            size = 5) + 
  coord_sf(xlim = c(-88, -78), ylim = c(24.5, 33), 
           expand = F)
```
]
.pull-right[
![](04_annotations_figs/f2-1.png)
]

---

## Looking at the Florida election

.pull-left[
```{r g1, eval = F, echo = T}
source(fs::path('data','florida.R'))
head(florida_election)
florida_election <- florida_election %>% 
  mutate_at(vars(ends_with('perc')), 
            ~as.numeric(str_remove(., '%')))
head(florida_election)
saveRDS(florida_election, fs::path('data', 'florida_election.rds'))
```
]
.pull-right[
```{r, eval=T, echo = F, ref.label='g1'}
```

]

---

## Looking at the Florida election

.pull-left[
Now we need the map information
```{r g2, eval = F, echo = T}
library(maps)
counties <- st_as_sf(maps::map('county', plot = F, 
                               fill = T), crs=4269)
head(counties)
counties <- counties %>% 
  dplyr::filter(str_detect(ID, 'florida'))
counties <- counties %>% 
  separate(ID, c('State','County'), sep = ',') %>% 
  mutate_at(vars(State:County), str_to_title)
```
]
.pull-right[
```{r, eval=T, echo=F, ref.label='g2'}

```

]

---

## Looking at the Florida election

.pull-left[
The nice thing about the `sf` package is that it renders all the data into a data frame, so adding to it, or merging new data becomes easy. 

We will now merge the election data with the map data

```{r g3, eval = F, echo = T}
florida_election <- readRDS(fs::path('data', 'florida_election.rds'))
election_by_county <- counties %>% 
  left_join(florida_election)
head(election_by_county, 2)
```
]
.pull-right[

```{r, eval=T, echo=F, ref.label='g3'}

```

]

---

## Looking at the Florida election

.pull-left[
Now we're ready to plot

```{r g4, eval = T, echo = T, error = T}
ggplot(election_by_county) + 
  geom_sf(aes(fill = Gore_perc)) + 
  scale_fill_viridis_c(option = 'plasma') + 
  labs(caption = 'Source: Wikipedia')
```
]
.pull-right[
![](04_annotations_figs/g4-1.png)
]

---

## Looking at the Florida election

.pull-left[

We can clean this up a bit, and add surrounding states


```{r g5, eval = T, echo = T, error = T}
plt_map <- ggplot(data = world)+
  geom_sf() + 
  geom_sf(data = states, fill = NA) + 
  geom_sf(data = election_by_county, 
          aes(fill=Gore_perc)) + 
  geom_label(data = states %>% #<<
               dplyr::filter(ID != 'Florida'), #<<
             aes(X, Y, label = ID), #<<
            size = 5) +
  coord_sf(xlim = c(-88, -78), ylim = c(24.5, 33),  
           expand = F) +
  labs(x = '', y = '', fill = 'Percentage for Gore') + 
  scale_fill_viridis_c(option = 'plasma')
plt_map
```
]
.pull-right[
![](04_annotations_figs/g5-1.png)
]
